# 更新日志

## [2025-11-28]

### 修复
- **小红书头像提取修复**：修复取头像时错误获取第一个评论者头像而非作者头像的问题。改进逻辑：优先使用作者链接附近的头像，排除评论区元素
- **一键发布 Twitter 识别修复**：扩展 Twitter/X 页面匹配规则，新增 `www.`、`mobile.` 等 URL 变体支持；添加 `tabs` 权限以支持通过 URL 查询标签页

### 文档
- **Cursor Rules 设置文档**：创建 `docs/cursor-rules-setup.md`，提供项目初始化时配置 Cursor 规则的完整指南
  - 包含 4 个规则文件的详细内容和用途说明（changlogs、git-commit、progress、script-docstring）
  - 提供快速初始化脚本，可一键创建所有规则文件
  - 所有内容已泛化，避免硬编码特定项目信息，可适用于任意项目

## [2025-11-28]

### 新功能
- **深色/浅色模式**：SidePanel 新增主题切换功能（跟随系统/浅色/深色），适配不同环境阅读需求
- **评论区内容收集**：新增设置开关，可收集评论区内容。作者自己的补充内容（线程/回复）会整合到摘要中，其他用户的精彩评论会单独展示为"评论区观点"
- **摘要 Markdown 渲染**：摘要卡片现在支持 Markdown 格式渲染，长内容会使用列表、加粗等格式，大幅提升可读性

### 改进
- **摘要卡片头像显示**：在作者名称左侧新增头像展示，自动显示作者真实头像
    - Twitter 和小红书在收集时直接抓取头像 URL
    - Twitter 备用方案：通过 unavatar.io 加载
    - 最终回退：显示首字母作为占位
- **创作参考交互重构**：优化了创作页面选择参考素材的交互流程
    - 创作页面新增"创作参考"区域，可直观查看和管理已选参考
    - 点击"从收藏中选择"进入选择模式，卡片显示勾选框
    - 选择模式下底部固定确认按钮，选完后自动返回创作页
    - 移除了收藏库中卡片的默认选中功能，避免误操作
- **UI 重构与视觉升级**：
    - **极简风格**：采用 Zinc 色系与卡片式设计，移除左侧时间线
    - **视觉降噪**：移除 @handle 显示，将操作按钮改为悬浮显示
    - **体验优化**：顶部栏增加毛玻璃效果，时间显示改为相对格式（如"2小时前"）
    - **交互细节**：优化选中态指示条，提升标签与按钮的触感反馈
- **UI 优化**：SidePanel 类型筛选改为下拉框样式，节省顶部空间
- **UI 更新**：将内容页面悬浮按钮、侧边栏和弹出窗口中的旧 Logo 替换为新设计的松鼠 Logo
- **Logo 重设计**：使用新的松鼠侧面剪影 Logo，替换原有的 SVG Logo，风格更现代简约
- **图片识别功能全局化**：图片识别功能不再限于小红书，现在在所有平台（包括 Twitter/X）收藏内容时都可以使用图片识别
- **自定义摘要提示词优化**：设置页面中的自定义摘要提示词现在直接显示默认值，而不是以 placeholder 形式展示，方便用户直接修改

### 修复
- **收藏库选中态修复**：修复非选择模式下，已被添加为创作参考的卡片仍显示选中样式的问题
- **UI 交互修复**：修复了在移除 @handle 显示后，点击作者名称无法跳转到个人主页的问题
- **图片识别优化**：将图片转换为 base64 格式再发送给 API，解决 API 服务器无法访问外部图片 URL 的问题
- **媒体过滤**：过滤掉头像、emoji 等非内容图片，只识别推文中的实际媒体图片
- 修复了设置页面中 `defaultLanguage` 类型断言使用 `any` 的 lint 错误
- **视觉模型完整独立配置**：新增视觉模型的完整独立配置（API Key、Base URL、模型名称），解决主模型不支持图片识别的问题。用户可以为图片识别配置完全不同的 API 服务商（如阿里云 `qwen-vl-max`），所有配置项留空则自动使用主配置
- **小红书作者识别修复**：修复作者名称会带上"关注"/"已关注"按钮文字的问题
- **小红书链接修复**：清理笔记 URL，移除可能过期的 xsec_token 等参数，确保链接可正常跳转
- **小红书用户主页链接修复**：正确提取作者个人主页链接，点击用户名可跳转到小红书个人主页
- **多图识别优化**：Twitter 支持识别最多 4 张图片，小红书支持识别最多 9 张图片
- **小红书图片过滤优化**：过滤掉静态资源、图标等无关图片，并对图片去重，只识别实际内容图片
- **小红书评论区收集**：为小红书添加评论区收集功能，支持收集作者补充内容和其他用户评论
- **SidePanel 样式修复**：修复当面板宽度缩小时，卡片内容无法自动收缩的问题，优化响应式布局体验
