# 灵感模式功能

## 📋 任务信息
- 类型：🔴 大功能 (L)
- 预计时间：3-4 小时
- 创建时间：2025-12-01
- 状态：✅ 已完成

## 🎯 目标
实现「灵感模式」功能，在创作前的调研阶段自动采集用户浏览的内容，作为创作参考素材。

## 🔧 技术方案
- 存储：chrome.storage.session（会话级，关闭浏览器清空）
- 采集方式：
  - 列表页：Intersection Observer 监测可见帖子，采集标题/摘要
  - 详情页：URL 变化监测，采集完整内容+评论区
- 通信：Content Script ↔ Background ↔ SidePanel 实时同步

## ✅ 验收标准
- [x] 类型定义完成
- [x] Storage 层支持会话存储
- [x] 小红书灵感采集实现
- [x] Twitter 灵感采集实现
- [x] SidePanel UI 灵感模式入口
- [x] Background 消息通信
- [ ] 功能测试验证

## 📦 边界
- 包含：灵感模式开关、自动采集、创作参考整合
- 不包含：AI 摘要、转为收藏

## 📋 实施计划

- [x] 1. 扩展数据类型 (15min)
  - [x] InspirationItem 类型定义
  - [x] 消息类型定义
- [x] 2. Storage 层 (20min)
  - [x] 灵感模式状态存储
  - [x] 灵感数据 session storage
- [x] 3. Content Script - 小红书 (45min)
  - [x] 列表页采集（标题+摘要）
  - [x] 详情页采集（完整内容+评论区）
  - [x] 消息通信
- [x] 4. Content Script - Twitter (45min)
  - [x] 列表页采集
  - [x] 详情页采集
- [x] 5. SidePanel UI (60min)
  - [x] 灵感模式开关
  - [x] 灵感内容列表展示
  - [x] 参考来源切换（收藏/灵感）
- [x] 6. Background 消息通信 (20min)
  - [x] 灵感模式状态广播
  - [x] 灵感数据转发
- [ ] 7. 测试验证 (30min)

## 📝 设计细节

### 数据结构

```typescript
interface InspirationItem {
  id: string;
  platform: 'twitter' | 'xiaohongshu';
  author: string;
  authorAvatar?: string;
  title?: string;           // 列表页采集
  summary?: string;         // 列表页采集的摘要
  content?: string;         // 详情页采集的完整内容
  url: string;
  thumbnail?: string;       // 缩略图
  capturedAt: number;       // 采集时间
  isDetail: boolean;        // 是否为详情页采集
}
```

### UI 交互

```
创作 Tab
├── 创作参考
│   ├── [收藏] [灵感]  ← Tab 切换
│   ├── 灵感模式开关   ← 仅在灵感 Tab 显示
│   └── 内容列表
└── 创作表单
```

